{"version":3,"sources":["../js/form_feedback.js"],"names":["nameFieldFeedback","document","querySelector","parentNode","feedbackField","formFedback","getElementById","selectFeedback","btnForm","nameFeedbackFieldUtiles","initializeField","feedbackFieldUtiles","addEventListener","classList","add","$","ready","on","e","preventDefault","removeClass","remove","data","FormData","ajax","url","method","dataType","success","msg","reset","FOCUSED_CLASS_NAME","fancybox","open","src","type","html","error","showErrors","cache","contentType","processData","each","i","responseJSON","errors","attr","parent","closest","length","addClass","j","append","ERROR_CLASS_NAME"],"mappings":"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","sourcesContent":["const nameFieldFeedback = document.querySelector('#feedback_form__id input[name=\"name\"]').parentNode;\r\nconst feedbackField = document.querySelector('#feedback_form__id input[name=\"email\"]').parentNode;\r\nconst formFedback = document.getElementById('feddback_form__id');\r\nconst selectFeedback = document.getElementById('feedback_select');\r\nconst btnForm = document.getElementById('btn_form');\r\n\r\nconst nameFeedbackFieldUtiles = initializeField(nameFieldFeedback);\r\nconst feedbackFieldUtiles = initializeField(feedbackField);\r\n\r\nselectFeedback.addEventListener('change', () => {\r\n    selectFeedback.classList.add('input_select_selected');\r\n});\r\n\r\n$(document).ready(($) => {\r\n    $('#feddback_form__id').on('submit', function (e) {\r\n        e.preventDefault();\r\n        $('.input__error').removeClass('input__error');\r\n        $('.input__error_mmsg').remove();\r\n\r\n        let data = new FormData(document.getElementById('feddback_form__id'));\r\n\r\n        $.ajax({\r\n            url: 'http://study.xeol.ru/api/new_order',\r\n            method: 'post',\r\n            dataType: 'json',\r\n            data: data,\r\n            success: function (msg) {\r\n                document.getElementById('feddback_form__id').reset();\r\n                document.getElementById('feedback_name').parentNode.classList.remove(FOCUSED_CLASS_NAME)\r\n                document.getElementById('feedback_select').classList.remove(\"input_select_selected\")\r\n                document.getElementById('feedback_textarea').parentNode.classList.remove(FOCUSED_CLASS_NAME)\r\n                $.fancybox.open({\r\n                    src: '.modal-success',\r\n                    type: \"inline\",\r\n                })\r\n                $('.success-result').html(msg.success);\r\n            },\r\n            error: function (msg) {\r\n                showErrors(msg)\r\n            },\r\n            cache: false,\r\n            contentType: false,\r\n            processData: false,\r\n\r\n        });\r\n    })\r\n\r\n})\r\n\r\nfunction showErrors(msg) {\r\n\r\n    // перебираем инпуты через цикл each\r\n    $('#feddback_form__id input, #feddback_form__id select').each(function () {\r\n// перебираем errors через цикл\r\n        for (let i in msg.responseJSON.errors) {\r\n             // сравниваем атрибут name с названием у errors(email,place,name)\r\n            if (i == $(this).attr('name')) {\r\n                 // если есть ошибка, входим в условие ниже, где ищем closest с названием '.input_block1' (наши 2 поля имеют класс input_block1)\r\n                let parent = $(this).closest('.input_block1');\r\n                 // если closest не нашли, значит ошибка в select\r\n                if (!parent.length)\r\n                 // тогда мы ищем closest '.feedback-select_wrap'\r\n                    parent = $(this).closest('.feedback-select_wrap');\r\n                    //добавляем элементу класс ошибки \r\n                parent.addClass('input__error')\r\n                // перебираем массив errors и добавляем название ошибки и append`им в разметку конкатенируем  с подходящей ошибкой\r\n                for (let j in msg.responseJSON.errors[i]) {\r\n                    parent.append('<p class=\"input__error_mmsg\">' + msg.responseJSON.errors[i][j] + '</p>');\r\n                }\r\n            }\r\n        }\r\n    })\r\n}\r\n\r\nselectFeedback.addEventListener('change', () => {\r\n    selectFeedback.classList.remove(ERROR_CLASS_NAME);\r\n})"],"file":"form_feedback.js"}