{"version":3,"sources":["../js/prize.js"],"names":["openBtn","document","getElementById","popUp","closeBtn","nameField","querySelector","parentNode","emailField","form","selectPrize","popUpToggle","classList","toggle","ERROR_CLASS_NAME","FOCUSED_CLASS_NAME","SELECT_SELECTED","initializeField","field","input","getElementsByTagName","fieldError","reset","clearError","remove","innerText","addEventListener","add","value","addError","errorText","getValue","focus","nameFieldUtiles","emailFieldUtiles","onclick","handleSubmit","event","preventDefault","nameValue","emailValue","test","data","name","email","prize","url","URL","search","URLSearchParams","toString","fetch","then","json"],"mappings":"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","sourcesContent":["const openBtn = document.getElementById('btn_prize_open');\r\nconst popUp = document.getElementById('prize_pop-up');\r\nconst closeBtn = document.getElementById('prize_pop-up__close');\r\nconst nameField = document.querySelector('#prize_pop-up input[name=\"feedback_name\"]').parentNode;\r\nconst emailField = document.querySelector('#prize_pop-up input[name=\"email\"]').parentNode;\r\nconst form = document.getElementById('form_prize__id');\r\nconst selectPrize = document.getElementById('feedback_select_prize');\r\n\r\nfunction popUpToggle() {\r\n    popUp.classList.toggle('hidden');\r\n};\r\n\r\nexport const ERROR_CLASS_NAME = 'input__error';\r\nexport const FOCUSED_CLASS_NAME = 'input__filled';\r\nexport const SELECT_SELECTED = 'input_select_selected';\r\nexport function initializeField(field) {\r\n    let input;\r\n    if (field.getElementsByTagName('input')[0]) {\r\n        input = field.getElementsByTagName('input')[0];\r\n    } else {\r\n        input = field.getElementsByTagName('textarea')[0];\r\n    };\r\n\r\n    const fieldError = field.querySelector('.input__error_mmsg');\r\n\r\n    reset();\r\n\r\n    function clearError() {\r\n        field.classList.remove(ERROR_CLASS_NAME);\r\n        fieldError.innerText = \"\";\r\n    };\r\n\r\n    input.addEventListener('focus', function () {\r\n        field.classList.add(FOCUSED_CLASS_NAME);\r\n    });\r\n\r\n    input.addEventListener('blur', function () {\r\n        if (!input.value) {\r\n            field.classList.remove(FOCUSED_CLASS_NAME)\r\n        };\r\n    });\r\n\r\n    input.addEventListener('input', () => {\r\n        clearError();\r\n    });\r\n\r\n    selectPrize.addEventListener('change', () => {\r\n        selectPrize.classList.remove(ERROR_CLASS_NAME)\r\n    });\r\n\r\n    function reset() {\r\n        input.value = '';\r\n        field.classList.remove(FOCUSED_CLASS_NAME);\r\n        clearError();\r\n    }\r\n\r\n    return {\r\n        addError(errorText) {\r\n            field.classList.add(ERROR_CLASS_NAME);\r\n            fieldError.innerText = errorText;\r\n        },\r\n        getValue() {\r\n            return input.value;\r\n        },\r\n        focus() {\r\n            input.focus();\r\n        },\r\n        reset: reset\r\n    };\r\n};\r\n\r\nconst nameFieldUtiles = initializeField(nameField);\r\nconst emailFieldUtiles = initializeField(emailField);\r\n\r\nopenBtn.addEventListener('click', () => {\r\n    popUpToggle();\r\n    nameFieldUtiles.focus();\r\n});\r\n\r\nselectPrize.addEventListener('change', () => {\r\n    selectPrize.classList.add('input_select_selected');\r\n});\r\n\r\ncloseBtn.onclick = popUpToggle;\r\n\r\nexport function handleSubmit(event) {\r\n    event.preventDefault();\r\n    const nameValue = nameFieldUtiles.getValue();\r\n    const emailValue = emailFieldUtiles.getValue();\r\n\r\n    if (!nameValue) {\r\n        nameFieldUtiles.addError('Необходимо указать имя');\r\n        return;\r\n    }\r\n    \r\n    if (!emailValue) {\r\n        emailFieldUtiles.addError('Укажите email');\r\n        return;\r\n    }\r\n\r\n    if (!/^[\\w-]{2,16}@[\\w]{3,16}\\.[a-z]{2,3}$/i.test(emailValue)) {\r\n        emailFieldUtiles.addError('Укажите корректный email');\r\n        return;\r\n    }\r\n\r\n    if (selectPrize.value === \"none\") {\r\n        selectPrize.classList.add(ERROR_CLASS_NAME);\r\n        return;\r\n    }\r\n\r\n    const data = {\r\n        name: nameValue,\r\n        email: emailValue,\r\n        prize: selectPrize.value,\r\n    };\r\n\r\n    const url = new URL('http://inno-ijl.ru/multystub/stc-21-03/feedback');\r\n    url.search = new URLSearchParams(data).toString();\r\n\r\n    fetch(url.toString())\r\n        .then(data => data.json())\r\n        .then((data) => {\r\n            popUpToggle();\r\n            nameFieldUtiles.reset();\r\n            emailFieldUtiles.reset();\r\n        })\r\n}\r\n\r\nform.addEventListener('submit', handleSubmit);"],"file":"prize.js"}