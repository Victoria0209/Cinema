{"version":3,"sources":["../js/single-film.js"],"names":["searchParams","URLSearchParams","location","search","filmId","split","likes","document","getElementById","stars","querySelectorAll","fetchKinopoiskFilmData","filmDetailsRequest","answer","json","filmData","data","header","description","posterImage","premiere","textContent","nameRu","src","posterUrl","premiereRu","fethcFilmMeta","fetch","body","views","ratingNumber","rating","ratings","reduce","a","b","length","intRating","Math","round","floor","i","star","classList","add","likeIcon","addEventListener","contains","likesCount","parseInt","innerHTML","method","headers","JSON","stringify","dataset","value"],"mappings":"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","sourcesContent":["const searchParams = new URLSearchParams(location.search);\r\n// const filmId = searchParams.get('id');\r\nconst filmId = location.search.split('?id')[1];\r\n\r\nconst likes = document.getElementById('sf-likes');\r\nconst stars = document.querySelectorAll('.rt-star');\r\n\r\n\r\nconst fetchKinopoiskFilmData = async () => {\r\n    const answer = await filmDetailsRequest(filmId);\r\n    const {\r\n        data: filmData\r\n    } = await answer.json();\r\n\r\n    const header = document.getElementById('sf-header');\r\n    const description = document.getElementById('sf-desc');\r\n    const posterImage = document.getElementById('sf-poster');\r\n    const premiere = document.getElementById('sf-premiere');\r\n\r\n    header.textContent = filmData.nameRu;\r\n    description.textContent = filmData.description;\r\n    posterImage.src = filmData.posterUrl;\r\n    premiere.textContent = filmData.premiereRu;\r\n};\r\n\r\nconst fethcFilmMeta = async () => {\r\n    const answer = await fetch(`http://inno-ijl.ru/multystub/stc-21-03/film/${filmId}`)\r\n    const {\r\n        body\r\n    } = await answer.json();\r\n\r\n    const views = document.getElementById('sf-views');\r\n    const ratingNumber = document.getElementById('sf-rating-number');\r\n\r\n    views.textContent = `${body.views} Views`;\r\n    likes.textContent = `${body.likes} Likes`;\r\n\r\n    const rating = body.ratings.reduce((a, b) => a + b, 0) / body.ratings.length;\r\n    const intRating = Math.round(rating);\r\n    ratingNumber.textContent = Math.floor(rating * 10) / 10;\r\n\r\n    for (let i = 0; i < stars.length; i++) {\r\n        if (i >= intRating) break;\r\n        const star = stars[i];\r\n        star.classList.add('star-selected')\r\n    }\r\n}\r\n\r\nconst likeIcon = document.getElementById(\"like-icon\");\r\nlikeIcon.addEventListener(\"click\", () => {\r\n    if (!likeIcon.classList.contains('like-icon__liked')) {\r\n        const likesCount = parseInt(likes.textContent, 10) + 1;\r\n        likes.innerHTML = `${likesCount} Likes`;\r\n        likeIcon.classList.add('like-icon__liked');\r\n\r\n        fetch(`http://inno-ijl.ru/multystub/stc-21-03/film/${filmId}/like`, {\r\n            method: 'POST',\r\n            headers: {\r\n                'Content-Type': 'application/json'\r\n            },\r\n        })\r\n    }\r\n})\r\n\r\nfor (const star of stars) {\r\n    star.addEventListener('click', () => {\r\n        fetch(`http://inno-ijl.ru/multystub/stc-21-03/film/${filmId}/rating`, {\r\n            method: 'POST',\r\n            headers: {\r\n                'Content-Type': 'application/json'\r\n            },\r\n            body: JSON.stringify({\r\n                rating: +star.dataset.value\r\n            })\r\n        });\r\n    })\r\n}\r\n\r\nfetchKinopoiskFilmData();\r\nfethcFilmMeta();"],"file":"single-film.js"}